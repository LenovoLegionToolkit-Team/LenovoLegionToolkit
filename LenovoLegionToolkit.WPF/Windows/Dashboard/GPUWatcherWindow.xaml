<local:BaseWindow
    x:Class="LenovoLegionToolkit.WPF.Windows.Dashboard.GPUWatcherWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:LenovoLegionToolkit.WPF.Windows"
    xmlns:wpfui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:resources="clr-namespace:LenovoLegionToolkit.WPF.Resources"
    Title="GPU Process History"
    Width="500"
    Height="450"
    MinWidth="400"
    MinHeight="300"
    WindowStartupLocation="CenterOwner">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock 
                FontSize="20" 
                FontWeight="SemiBold" 
                Text="GPU Process History" />
            <TextBlock 
                x:Name="_statusText"
                Margin="0,4,0,0"
                FontSize="12"
                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                Text="Tracking processes using discrete GPU" />
        </StackPanel>

        <!-- Current Status -->
        <Border 
            Grid.Row="1" 
            Margin="0,0,0,12"
            Padding="12"
            Background="{DynamicResource ControlFillColorDefaultBrush}"
            CornerRadius="8">
            <StackPanel>
                <TextBlock 
                    FontSize="14" 
                    FontWeight="Medium" 
                    Text="Current Active Processes" />
                <TextBlock 
                    x:Name="_activeProcessesText"
                    Margin="0,4,0,0"
                    FontSize="12"
                    Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                    Text="None" 
                    TextWrapping="Wrap" />
            </StackPanel>
        </Border>

        <!-- History List -->
        <Border 
            Grid.Row="2" 
            Background="{DynamicResource ControlFillColorDefaultBrush}"
            CornerRadius="8">
            <ListView 
                x:Name="_historyList"
                Margin="8"
                Background="Transparent"
                BorderThickness="0"
                VirtualizingPanel.IsVirtualizing="True"
                VirtualizingPanel.VirtualizationMode="Recycling">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid Margin="0,4">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            
                            <Ellipse 
                                Grid.Column="0"
                                Width="8" 
                                Height="8" 
                                Margin="0,0,8,0"
                                Fill="{Binding StatusColor}" />
                            
                            <TextBlock 
                                Grid.Column="1"
                                VerticalAlignment="Center"
                                Text="{Binding ProcessName}"
                                TextTrimming="CharacterEllipsis" />
                            
                            <TextBlock 
                                Grid.Column="2"
                                VerticalAlignment="Center"
                                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                                Text="{Binding TimeInfo}" />
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </Border>

        <!-- Footer -->
        <Grid Grid.Row="3" Margin="0,12,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            
            <TextBlock 
                x:Name="_countText"
                Grid.Column="0"
                VerticalAlignment="Center"
                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                Text="0 entries" />
            
            <wpfui:Button
                x:Name="_clearButton"
                Grid.Column="1"
                Margin="0,0,8,0"
                Appearance="Secondary"
                Click="ClearButton_Click"
                Content="Clear History" />
            
            <wpfui:Button
                Grid.Column="2"
                Appearance="Primary"
                Click="CloseButton_Click"
                Content="Close" />
        </Grid>
    </Grid>
</local:BaseWindow>
